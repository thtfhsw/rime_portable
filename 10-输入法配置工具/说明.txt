TSFTool 输入法设置工具 0.9.1.2

版本历史：
0.9.1.2：旧版本的 Windows10 不支持表情符号面板功能，TSFTool 启动时会报错。此版本修订这一问题。
0.9.1.1：某种输入法禁用时，如果其已被设置为默认输入法，则将默认输入法改为语言列表。英文键盘布局在禁用/启用时，增加一个延时关闭的提示对话框，以免操作过快引起异常。
	 增加删除顽固存在的英语美工键盘布局功能。
0.9.1.0：全部重写代码，使用不同的方式处理，支持旧的 IMM 框架输入法，修复一些 Bug。此版本需要管理员权限。增加 32 位版本，32位版本也可以正常支持 64 位的 Windows10。
0.9.0.0：初始版本，只支持 TSF框架输入法。

前言：
    Windows10 的输入法模块是个一塌糊涂的项目，虽然说是由 IMM 框架完全升级到了 TSF 框架，但实际上还是有很多东西沿用旧的，也能部分支持 IMM框架。打开注册表观察输入法相关的内容就会发现有多种不同风格的配置写法混杂在一起，简直是随心所欲。随着 Windows Update 的升级还在不停地改动，各种功能设置藏来藏去让你找不到，深受老鸟们喜爱的“美式键盘”也被隐藏了起来。现在想来，还是挺怀念 Windows7 的，至少是设置界面集中，功能完整。
以前的 IMETool 输入法设置工具是完全基于 IMM 框架的，已经不堪使用。最近新写了个 TSFTool，算是对 IMETool 的怀念吧。
    几点说明如下：
一、关于热键
1. 切换热键修改后立即生效，但只对新打开窗口有效，原有窗口仍是旧的热键有效。
2. 切换热键可以单独选择左/右控制键，但是重启后会变回左右双键同时有效，这是 Windows 的设置功能混乱造成的，重载键盘布局即可重新生效。可以点击设置工具右下角的“刷新”按钮，也可以由命令行执行 tsftool /r 或 tsftool /refresh 重载键盘布局。
3. TSF 框架输入法和旧的 IMM 框架输入法可支持的热键范围不同。IMM 输入法支持的热键更多，且可以选择左/右控制键。
4. 按照以前的规律，简体中文、繁体中文和朝鲜语都有三组切换热键，日语只有一组，配置分别写在注册表的不同位置。观察 Windows10 发现好像只有简体中文和繁体中文还在使用，没有深入研究，暂时还按照以前的设定来做。
4. 输入法热键的重码检查暂时只在当前当前语言下进行，其它语言自行注意即可。功能待以后改进。但是三组通用切换热键允许不同语言重码，互不影响。
5. 在 Windows10 的热键设置中对“~”键的定义有误，无法生效，为保持兼容性本工具也保留了这个定义；另Windows10 热键设置中定义的“抑音符”实际为小键盘的数字0。
6. 使用本工具设置的热键
二、关于键盘布局
1. Windows10 从 1903 版本开始，已经无法正常将中文简体-美式键盘显示在输入法列表中了（实际是存在并启用的）。为了方便一些老用户，我在程序的输入法列表里硬加了一个“美式键盘”，以蓝色显示，可以正常使用。但是我发现，当切换到美式键盘后，是无法用打开/关闭输入法的切换热键“Ctrl+空格”切换到其它输入法的，只有改用切换键盘布局热键“Ctrl+Shift”或徽标键+空格键。我个人建议是禁用美式键盘，然后把最常用的输入法设置初始状态为“英文”，再用“Ctrl+空格”就可以正常切换了。
2. 暂时只支持 0409 这一种英文键盘布局。
3. 因为某些原因，在对美式键盘进行启用、禁用操作时，刷新需要 3~4 秒，注意操作不要太快。
三、其它
1. 所有设置修改后立即生效，没有设计“确定”、“应用”这类功能。
2. 本工具支持 Windows10 32/64 位版本，32 位版本程序在 64 位操作系统下运行正常。Windows7/8 等以前的操作系统的设置实际差异较大，不再支持。
3. 如果安装了多种语言的输入法，可以从底部的已安装语言列表中切换进行设置。
4. 输入法列表中显示为“粗体” 的条目表示此输入法已设置为默认输入法，可以从列表上点击右键，从弹出菜单里修改相关设置。
5. 每种语言下应至少保留一种输入法或键盘。
6. 如果要添加/删除某些输入法语言，请转到操作系统的设置/时间和语言/语言下进行设置。尝试过直接删除语言，发现容易造成输入法状态混乱，暂时取消了这个功能。
7. 偶尔会出现工具里的输入法列表和实际的输入法列表不太一致的现象，来回调整几次刷新刷新就会正常。主要原因是因为 Windows 在语言选项中的输入法列表和任务栏上的输入法列表是两个不同的配置，有时候条目数量和顺序会不一致，通过输入法工具设置会纠正这个问题。
8. 某些输入法（如小狼毫）在卸载不完全时，TSFTool 的输入法列表里可能会存在空行，以后的版本会想办法解决这个问题。

							Silence
							2019年11月6日